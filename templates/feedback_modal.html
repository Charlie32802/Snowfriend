{% load static %}

<!-- Feedback Modal -->
<div class="modal-overlay" id="feedbackModal">
    <div class="modal-content feedback-modal-content">
        <h2 class="modal-title">Share Your Feedback</h2>
        <p class="modal-text">Help us improve Snowfriend. Your feedback is anonymous and appreciated.</p>

        <div class="modal-privacy-box">
            <div class="modal-privacy-item">
                <svg class="modal-privacy-icon" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M13.5 4.5L6 12L2.5 8.5" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round" />
                </svg>
                <span><strong>Anonymous:</strong> No personal information required</span>
            </div>
            <div class="modal-privacy-item">
                <svg class="modal-privacy-icon" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M13.5 4.5L6 12L2.5 8.5" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round" />
                </svg>
                <span><strong>Private:</strong> Your feedback is kept confidential</span>
            </div>
        </div>

        <form id="feedbackForm" enctype="multipart/form-data">
            {% csrf_token %}
            
            <!-- Two Column Layout -->
            <div class="feedback-form-container">
                <!-- Left Column: Stars + Message -->
                <div class="feedback-left-column">
                    <!-- Star Rating -->
                    <div class="feedback-section">
                        <label class="feedback-label">How would you rate your experience?</label>
                        
                        <!-- Rating Tooltip -->
                        <div class="rating-tooltip" id="ratingTooltip">
                            <svg class="rating-tooltip-icon" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-width="2"/>
                                <path d="M8 4V8M8 10.5V11" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            <span>Please select a rating</span>
                        </div>
                        
                        <div class="star-rating" id="starRating">
                            <input type="radio" name="rating" value="5" id="star5">
                            <label for="star5" class="star" data-value="5">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z" 
                                          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </label>
                            
                            <input type="radio" name="rating" value="4" id="star4">
                            <label for="star4" class="star" data-value="4">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z" 
                                          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </label>
                            
                            <input type="radio" name="rating" value="3" id="star3">
                            <label for="star3" class="star" data-value="3">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z" 
                                          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </label>
                            
                            <input type="radio" name="rating" value="2" id="star2">
                            <label for="star2" class="star" data-value="2">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z" 
                                          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </label>
                            
                            <input type="radio" name="rating" value="1" id="star1">
                            <label for="star1" class="star" data-value="1">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z" 
                                          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </label>
                        </div>
                        <p class="rating-text" id="ratingText">Select a rating</p>
                    </div>

                    <!-- Message Box -->
                    <div class="feedback-section">
                        <label class="feedback-label" for="feedbackMessage">Your Feedback</label>
                        <textarea id="feedbackMessage" name="message" class="feedback-textarea" 
                                  placeholder="Share your thoughts, suggestions, or concerns..." 
                                  rows="5" maxlength="1000" required></textarea>
                        <p class="char-counter"><span id="charCount">0</span>/1000 characters</p>
                    </div>
                </div>

                <!-- Right Column: Image Upload -->
                <div class="feedback-right-column">
                    <div class="feedback-section">
                        <label class="feedback-label">Attach an Image (Optional)</label>
                        <div class="image-upload-area" id="imageUploadArea">
                            <input type="file" id="feedbackImage" name="image" accept="image/*" hidden>
                            <div class="upload-prompt" id="uploadPrompt">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15" 
                                          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M17 8L12 3L7 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M12 3V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                <p>Click to upload or drag and drop</p>
                                <p class="upload-hint">PNG, JPG, GIF up to 5MB</p>
                            </div>
                            <div class="image-preview" id="imagePreview" style="display: none;">
                                <img id="previewImg" src="" alt="Preview">
                                <button type="button" class="remove-image" id="removeImage" aria-label="Remove image">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-actions">
                <button type="button" class="modal-button modal-button-cancel" id="cancelFeedback">Cancel</button>
                <button type="submit" class="modal-button modal-button-confirm" id="submitFeedback">
                    <span class="button-text">Submit Feedback</span>
                    <img src="{% static 'images/snowflake_loading_logo.png' %}" 
                         alt="Loading" 
                         class="button-loading-spinner" 
                         id="submitSpinner">
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Notification Container for Landing Page -->
<div class="notification-container" id="feedbackNotificationContainer"></div>

<link rel="stylesheet" href="{% static 'css/feedback.css' %}">
<script src="{% static 'js/feedback.js' %}" defer></script>